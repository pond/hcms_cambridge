@import 'http://yui.yahooapis.com/pure/0.6.0/menus-min.css';

//////////////////////////////////////////////////////////////////////////////
// Fonts
//////////////////////////////////////////////////////////////////////////////

@import url( 'http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' );

@font-face {
  font-family: 'TrajanPro-bold';
  src: url( 'TrajanPro-Bold.ttf' );
}

//////////////////////////////////////////////////////////////////////////////
// Variables
//////////////////////////////////////////////////////////////////////////////

$container_width: 800px;
$content_width: 600px;
$content_padding_lr: 50px;

$container_width_narrow: $container_width / 2;
$content_width_narrow: $content_width / 2;
$content_padding_lr_narrow: $content_padding_lr / 2;

@mixin content_metrics {
  width: $content_width;
  margin: 0;
  padding: 0 $content_padding_lr 0 $content_padding_lr;
}

@mixin content_metrics_narrow {
  width: $content_width_narrow;
  margin: 0;
  padding: 0 $content_padding_lr_narrow 0 $content_padding_lr_narrow;
}

@mixin standard_shadow {
  -webkit-box-shadow: 0px 0px 5px 2px rgba( 0, 0, 0, 0.25 );
  -moz-box-shadow: 0px 0px 5px 2px rgba( 0, 0, 0, 0.25 );
  box-shadow: 0px 0px 5px 2px rgba( 0, 0, 0, 0.25 );
}

@mixin no_shadow {
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none;
}

@mixin standard_spinner {
  background: url( '/assets/spinner.png' ) center center no-repeat;
}

//////////////////////////////////////////////////////////////////////////////
// Shared styles
//////////////////////////////////////////////////////////////////////////////

body {
  font-size: 14pt;

  h1, h2, h3, h4, h5, h6, nav a {
    font-weight: bold;
    font-family: "TrajanPro-Bold", serif;
  }

  h1 {
    font-size: 27pt;
  }
}

input, select {
  font-size: 14pt;
  line-height: 150%;
  margin: 5px 0;
}

section.header, section.footer, section.main, .redactor-editor {
  width: $container_width;
  margin: 0 auto;
  font-family: 'Lora', serif;
}

section.header {
  position: relative;
  height: 191px;
  background: url( 'clipboard_top_slice.png' ) bottom center no-repeat;

  #logo {
    position: absolute;
    top: 77px;
    left: 30px;
  }

  nav {
    position: absolute;
    top: 91px;
    right: 180px;

    a, a:visited {
      display: inline-block;
      padding-left: 20px;
      color: #332d18;
      font-size: 2.5em;
      opacity: 0.9;
    }

    a:hover {
      color: #534d38;
    }
  }
}

section.main, .redactor-box {
  min-height: 352px;
  color: #000;

  section.content > h1:first-child,
  section.content > h2:first-child,
  section.content > h3:first-child,
  section.content > h4:first-child,
  section.content > h5:first-child,
  section.content > h6:first-child,
  section.content >  p:first-child {
    margin-top: 20px;
  }

  /* Without this, WebKit completely destroys the layout assigning large
   * tracts of white space either above, and/or below the section.main block.
   * Firefox shows no such issues and there's no logic to it, as indeed
   * adding in this transparent border shows.
   */

  border-bottom: 1px solid transparent;
  margin-bottom: -1px;

  background: url( 'clipboard_mid_slice.png' ) 0 0 no-repeat;
  background-size: 800px 100%;

  nav, section.content, .redactor-editor {
    @include content_metrics;
  }

  nav {

    padding-top: 20px;
    padding-bottom: 25px;
    text-align: center;

    .pure-menu-horizontal {
      overflow: visible !important;

      li {
        text-align: left;
        a { padding-top: 4px; }

        &.current_page {
          margin-bottom: -2px;
          border-bottom: 2px solid rgba( 0, 0, 0, 0.2 );
        }
      }
    }

    a {
      display: inline-block;
      padding: 0 10px;
      text-decoration: none;
      color: #332d18;
      font-size: 18pt;
    }
  }

  img {
    @include standard_shadow;
    @include standard_spinner;
  }

  img[ align = 'right' ] {
    margin: 0 10px 10px 0;
  }

  img[ align = 'left' ] {
    margin: 0 0 10px 10px;
  }

  /* Redactor doesn't understand an iframe wrapped in any containers so
   * we just have to make do with hard-coded sizes on an assumption of a
   * 16:9 video inside any such frame, or something where 16:9 is an
   * acceptable ratio.
   */

  iframe {
    margin-left: auto;
    margin-right: auto;
    width: 512px;
    height: 288px;

    @include standard_shadow;
    @include standard_spinner;
  }

  img.no_shadow, iframe.no_shadow {
    @include no_shadow;
  }

  /* For the last image in the last paragraph in the container (be it
   * Redactor or page display), or for the last image inside the
   * wrapper DIV inside the page display, or the last image inside a
   * Redactor container, make sure top/bottom margins are adjusted to
   * account for shadow stuff; or make sure there's margin to any
   * content in the footer. Need to use "!important" to override any
   * margin specifics inside Redactor for this special case.
   */

  p:last-child > img:not( [ class = 'no_shadow' ] ):last-child,
  & > div      > img:not( [ class = 'no_shadow' ] ):last-child,
  &            > img:not( [ class = 'no_shadow' ] ):last-child {

    margin-top:    15px !important;
    margin-bottom: 15px !important;
  }

  & > div > img:last-child,
  & >       img:last-child {

    margin-bottom: 35px !important;
  }
}

section.footer {
  height: 134px;
  background: url( 'clipboard_bottom_slice.png' ) top center no-repeat;

  section.footer_content {
    @include content_metrics;
    text-align: center;
  }
}

//////////////////////////////////////////////////////////////////////////////
// Narrow viewport / mobile variations
//////////////////////////////////////////////////////////////////////////////

@media only screen and (max-width: 720px) {

  input, select {
    width: 90%;
  }

  section.header, section.main, section.footer, .redactor-editor {
    width: $container_width_narrow;
  }

  section.header {
    height: 95px;
    background-size: 100%;

    #logo {
      top: 38px;
      left: 15px;
      width: 110px;
      height: 36px;
    }

    nav {
      top: 45px;
      right: 80px;

      a {
        display: inline-block;
        padding-left: 10px;
        color: #332d18;
        font-size: 1.8em;
      }
    }
  }

  section.main, .redactor-box {
    background-size: $container_width_narrow 100%;

    iframe {
      width: 256px;
      height: 144px;
    }

    img {
      max-width: 300px !important;
      min-height: 36px; // For the spinner, with fingers crossed no images are smaller! CSS hack :-/
      height: auto !important;
    }

    nav, section.content, .redactor-editor {
      @include content_metrics_narrow;
    }

    nav {
      padding-top: 15px;
      padding-bottom: 15px;

      a {
        font-size: 14pt;
      }
    }
  }

  section.footer {
    height: 67px;
    background-size: 100%;

    section.footer_content {
      @include content_metrics_narrow;
    }
  }
}
